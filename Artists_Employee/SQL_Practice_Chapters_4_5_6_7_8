-- Using the database Artists_Employee to make myself questions and trying to answer

--1. Is *Purchased AAC media* more used in *Pop* or *Drama* genre?
-- Answer: The use of the media is equal for both genres.

select genres.Name, COUNT(media_types.Name) AS Media_Purchased_AAC_Audio_File FROM genres, media_types 
where media_types.Name='Purchased AAC audio file' 
AND genres.Name IN ('Pop', 'Drama')
GROUP BY genres.Name;

-- 2.  Show the employees and how many customers they are helping in decending order.
-- Answer: code.

select employees.FirstName || ' ' || employees.LastName AS Employee_Fullname, 
COUNT(customers.SupportRepId) AS How_Many_Costumers_Am_I_Helping 
FROM employees, customers 
WHERE employees.EmployeeId = customers.SupportRepId
GROUP BY employees.FirstName
ORDER BY employees.FirstName DESC;

-- USING CASE STATEMENTS

-- 3. Classify the invoices: show 'expensive' if price >=  9.50; 'moderate' if price >= 5.2 and price < 9.50 and 'cheap' if price < 5.2
-- Answer: code
select invoices.InvoiceId,
    CASE 
        WHEN invoices.Total >= 9.50 THEN 'EXPENSIVE'
        WHEN invoices.Total BETWEEN 5.2 AND 9.49 THEN 'MODERATE'
        ELSE 'CHEAP'
    END as classification_invoice_price
FROM invoices;

